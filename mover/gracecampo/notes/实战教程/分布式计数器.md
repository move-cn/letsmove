# å¦‚ä½•å®ç°ä¸€ä¸ªåˆ†å¸ƒå¼è®¡æ•°å™¨

ğŸ§‘â€ğŸ’»ä½œè€…ï¼šgracecampo

è¯´æ˜ï¼š
è¯¥æ•™ç¨‹åŸºäºsuiå®˜æ–¹å¼€å‘è€…æ–‡æ¡£ï¼Œè¿›è¡Œçš„æ˜¯å®æˆ˜æ“ä½œï¼Œéœ€è¦è¯»è€…å…·å¤‡ä¸€å®šçš„moveè¯­è¨€åŸºç¡€ã€‚
[å®˜æ–¹æ•™ç¨‹åœ°å€](https://docs.sui.io/guides/developer/app-examples/e2e-counter)ï¼šhttps://docs.sui.io/guides/developer/app-examples/e2e-counter

## å®æˆ˜è¯´æ˜
è¯¥å®æˆ˜é¡¹ç›®æ¶‰åŠçš„çŸ¥è¯†ç‚¹æœ‰ï¼š ç»“æ„ä½“ï¼Œå‡½æ•°ï¼Œå¯¹è±¡çš„æ‰€æœ‰æƒï¼ŒPTBç¼–ç¨‹ã€‚

é€šè¿‡æ­¤é¡¹ç›®ï¼Œä½ å¯ä»¥æ„å»ºä¸€ä¸ªï¼Œå…·å¤‡å‰åç«¯çš„åŸºç¡€`DAPP`ï¼Œå…è®¸ä»»ä½•äººé€šè¿‡æ­¤APPè¿›è¡Œè®¡æ•°å™¨çš„é€’å¢ï¼Œä½†é™åˆ¶åªæœ‰å¯¹è±¡çš„æ‰€æœ‰è€…å¯ä»¥è¿›è¡Œé‡ç½®è®¡æ•°å™¨ã€‚

### å‰ç½®æ¡ä»¶

> moveåŸºç¡€è¯­æ³•çŸ¥è¯†: ç»“æ„ä½“ ï¼Œå‡½æ•°å£°æ˜ ï¼Œå˜é‡å£°æ˜ï¼Œ å¯¹è±¡çš„æ‰€æœ‰æƒ ï¼Œå¯¹è±¡çš„èƒ½åŠ›

> reactå‰ç«¯åŸºç¡€çŸ¥è¯†ï¼š node , npm , reactæ¡†æ¶åŸºç¡€ , typescriptè¯­æ³•

### é¡¹ç›®åˆ†æ
> æœ¬é¡¹ç›®åˆ†ä¸º
>>    åˆçº¦éƒ¨åˆ†: è®¡æ•°å™¨ç»“æ„ä½“  é€’å¢å‡½æ•°   é‡ç½®å‡½æ•°

>>    å‰ç«¯éƒ¨åˆ†  é’±åŒ…ç»„ä»¶    åˆçº¦è°ƒç”¨
## ä»£ç éƒ¨åˆ†
### åˆ›å»ºé¡¹ç›®ç»“æ„
æ–°å»ºé¡¹ç›®ç›®å½•ï¼šcounter_project

```shell
mkdir counter_project && cd counter_project
```
åˆ›å»ºåˆçº¦éƒ¨åˆ†

```shell
sui move new counter_contracts
```

> å¯é€‰éƒ¨åˆ†ï¼š(å› ä¸ºä¾èµ–ä¸º`github`åœ°å€ï¼Œå›½å†…ç½‘é€Ÿå¯èƒ½è¾ƒæ…¢ï¼Œæ•…å°†å…¶æ”¹ä¸º`gitee`åœ°å€åŠ é€Ÿ)

>> ä¿®æ”¹tomlæ–‡ä»¶
>>```toml
>>[dependencies]
>>Sui = { git = "https://gitee.com/MystenLabs/sui.git", subdir = "crates/sui-framework/packages/sui-framework", rev = "framework/testnet" }
>>```

### åˆçº¦éƒ¨åˆ†è®²è§£

```move
module counter_contracts::counter_contracts{
    ///å£°æ˜è®¡æ•°å™¨ç»“æ„ä½“ï¼šèµ‹äºˆç»“æ„ä½“keyçš„èƒ½åŠ›
    /// ç»“æ„ä½“çš„å…ƒç´ æœ‰ï¼š
    /// id  ç”¨ä»¥åœ¨é“¾ä¸Šç´¢å¼•å¯¹è±¡
    /// owner å¯¹è±¡çš„æ‹¥æœ‰è€…
    /// value è®¡æ•°å™¨å€¼
    public struct Counter has key {
        id: UID,
        owner: address,
        value: u64
    }

    ///åˆ›å»ºä¸€ä¸ªè®¡æ•°å™¨:
    /// id é€šè¿‡object::new(ctx)åˆ›å»ºå¯¹è±¡å”¯ä¸€ç´¢å¼•
    /// å°†ownerå­—æ®µèµ‹å€¼ä¸ºå‡½æ•°è°ƒç”¨åœ°å€
    /// è®¡æ•°å™¨å€¼ç½®ä¸º0
    public fun create(ctx: &mut TxContext) {
        transfer::share_object(Counter {
            id: object::new(ctx),
            owner: ctx.sender(),
            value: 0
        })
    }
    ///é€’å¢å‡½æ•°ï¼š å°†è®¡æ•°å™¨å€¼+1
    public fun increment(counter: &mut Counter) {
        counter.value = counter.value + 1;
    }
    ///é‡ç½®è®¡æ•°å™¨å€¼ï¼š å¯¹è®¡æ•°å™¨æ‹¥æœ‰è€…è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœéè®¡æ•°å™¨çš„æ‹¥æœ‰è€…ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸
    public fun set_value(counter: &mut Counter, value: u64, ctx: &TxContext) {
        assert!(counter.owner == ctx.sender(), 0);
        counter.value = value;
    }
}
```

åˆçº¦éƒ¨åˆ†:

å£°æ˜è®¡æ•°å™¨ç»“æ„ä½“ï¼š

```move
    public struct Counter has key {
        id: UID,
        owner: address,
        value: u64
    }
```

è¯¥ç»“æ„ä½“ä½“æ‹¥æœ‰keyçš„èƒ½åŠ›ï¼Œæ‹¥æœ‰`key`èƒ½åŠ›çš„å¯¹è±¡ï¼Œå¿…é¡»å£°æ˜ä¸€ä¸ª`id`,æ­¤æ¡ä»¶æ˜¯æ‹¥æœ‰`key`çš„ç»“æ„ä½“çš„å¿…è¦æ¡ä»¶ï¼Œç”¨äºåœ¨é“¾ä¸Šåˆ›å»ºå¯¹è±¡å¹¶ç”¨ç”Ÿæˆçš„`idç´¢å¼•`

æˆ‘ä»¬èµ‹äºˆè¯¥å¯¹è±¡`id`,æ‹¥æœ‰è€…åœ°å€ `owner`ï¼Œä»¥åŠä¸€ä¸ªè®°å½•è®¡æ•°å™¨å€¼çš„å…ƒç´ ï¼š`value`

å£°æ˜åˆ›å»ºç»“æ„ä½“å‡½æ•°ï¼š
```move
    public fun create(ctx: &mut TxContext) {
        transfer::share_object(Counter {
            id: object::new(ctx),
            owner: ctx.sender(),
            value: 0
        })
    }
```
æ­¤å‡½æ•°å‚æ•°TxContextä¸ºä¸€ä¸ªåŒ…å«äº†å½“å‰æ­£åœ¨æ‰§è¡Œçš„äº¤æ˜“çš„ä¿¡æ¯ã€‚å®ƒæ˜¯ç”±è™šæ‹Ÿæœºåˆ›å»ºçš„ç‰¹æƒå¯¹è±¡ï¼Œ

å…¶ä¸­åŒ…å«äº†
sender: ç­¾ç½²å½“å‰äº¤æ˜“çš„ç”¨æˆ·åœ°å€ã€‚

tx_hash: å½“å‰äº¤æ˜“çš„å“ˆå¸Œå€¼ã€‚

epoch: å½“å‰çš„çºªå…ƒç¼–å·ã€‚

epoch_timestamp_ms: çºªå…ƒå¼€å§‹çš„æ—¶é—´æˆ³ï¼ˆä»¥æ¯«ç§’ä¸ºå•ä½ï¼‰ã€‚

ids_created: åœ¨æ‰§è¡Œäº¤æ˜“æ—¶åˆ›å»ºçš„æ–° ID çš„è®¡æ•°å™¨ï¼Œäº¤æ˜“å¼€å§‹æ—¶æ€»æ˜¯ä¸º 0ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œåœ¨èµ‹å€¼`owner`åœ°å€æ—¶ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨`ctx.sender()`ï¼Œè·å–äº†ç­¾ç½²å½“å‰äº¤æ˜“çš„ç”¨æˆ·åœ°å€ã€‚

`object::new(ctx)`æ˜¯ç”¨äºåœ¨ Sui ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼ˆUIDï¼‰çš„å‡½æ•°ï¼Œå®ƒéœ€è¦ä¸€ä¸ª `&mut TxContext` ä½œä¸ºå‚æ•°ï¼Œå¹¶è¿”å›ä¸€ä¸ªæ–°çš„ `UID`ã€‚è¿™ä¸ªå‡½æ•°ç¡®ä¿ç”Ÿæˆçš„ `UID` æ˜¯å”¯ä¸€çš„ï¼Œå¹¶ä¸”ä¸èƒ½åœ¨å¯¹è±¡è¢«åˆ é™¤åé‡ç”¨ã€‚

å°†`value`å…ƒç´ èµ‹å€¼ä¸º`0`

`transfer::share_object` æ˜¯ä¸€ä¸ªç”¨äºå°†å¯¹è±¡ç½®äºå…±äº«çŠ¶æ€çš„å‡½æ•°ã€‚ä¸€æ—¦å¯¹è±¡è¢«å…±äº«ï¼Œå®ƒå¯ä»¥è¢«ä»»ä½•äººé€šè¿‡å¯å˜å¼•ç”¨è®¿é—®å’Œä¿®æ”¹ã€‚è¿™ä¸ªæ“ä½œæ˜¯ä¸å¯é€†çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦å¯¹è±¡è¢«å…±äº«ï¼Œå®ƒå°†æ°¸è¿œä¿æŒå…±äº«çŠ¶æ€ã€‚

æˆ‘ä»¬é€šè¿‡transfer::share_objectæ–¹æ³•ï¼Œå°†ç»“æ„ä½“å¯¹è±¡ç½®äºå…±äº«çŠ¶æ€,ç”¨ä»¥ä½¿ä»»ä½•äººéƒ½å¯ä»¥æ“ä½œæ­¤å¯¹è±¡ã€‚

å£°æ˜é€’å¢å‡½æ•°ï¼š
```move
    public fun increment(counter: &mut Counter) {
        counter.value = counter.value + 1;
    }
```
æ­¤å‡½æ•°å‚æ•°ä¸ºå‰ä¸€ä¸ªå‡½æ•°`create`åˆ›å»ºçš„å¯¹è±¡ï¼Œé€šè¿‡`counter.value = counter.value + 1`ï¼Œè¿›è¡Œè®¡æ•°å™¨å€¼çš„é€’å¢

æˆ‘ä»¬åœ¨è°ƒç”¨æ—¶ï¼Œé€šè¿‡ä¼ å…¥å¯¹è±¡ID, å‡½æ•°ä¸­é€šè¿‡è·å–è®¡æ•°å™¨å¯¹è±¡çš„valueå…ƒç´ ï¼Œå¹¶å°†å…¶åŸæœ‰å€¼åŸºç¡€ä¸Š+1ï¼Œå®ç°è®¡æ•°å™¨å€¼çš„é€’å¢é€»è¾‘

é‡ç½®è®¡æ•°å™¨å€¼å‡½æ•°
```move
    public fun set_value(counter: &mut Counter, value: u64, ctx: &TxContext) {
        assert!(counter.owner == ctx.sender(), 0);
        counter.value = value;
    }
```
æ­¤å‡½æ•°é€šè¿‡ä¼ å…¥è®¡æ•°å™¨å¯¹è±¡`counter`ï¼Œå€¼`value`ï¼Œä»¥åŠäº¤æ˜“ä¸Šä¸‹æ–‡å¯¹è±¡`ctx`,é€šè¿‡åˆ¤æ–­`counter`å¯¹è±¡çš„owneråœ°å€ä¸`ctx`ä¸­ç­¾ç½²å½“å‰äº¤æ˜“çš„ç”¨æˆ·åœ°å€å¯¹æ¯”ï¼Œè¿›è¡Œæƒé™é™åˆ¶ã€‚

å°±æ˜¯è¯´è™½ç„¶å¯¹è±¡çš„å…±äº«çš„ï¼Œæ‰€æœ‰äººéƒ½å¯ä»¥é€šè¿‡`increment`å‡½æ•°è¿›è¡Œä¿®æ”¹`value`å€¼ï¼Œä½†æ˜¯é‡ç½®`value`åªæœ‰owneråœ°å€æ‰èƒ½è¿›è¡Œä¿®æ”¹

### å‘å¸ƒåˆçº¦
```shell
sui client publish
```
å¯ä»¥é€šè¿‡æ§åˆ¶å°çœ‹åˆ°ï¼Œæˆ‘ä»¬å‘å¸ƒçš„åˆçº¦åŒ…ä¿¡æ¯ï¼Œä»¥åŠåˆçº¦åŒ…çš„packageID
```text
UPDATING GIT DEPENDENCY https://gitee.com/MystenLabs/sui.git
INCLUDING DEPENDENCY Sui
INCLUDING DEPENDENCY MoveStdlib
BUILDING counter_contracts
Successfully verified dependencies on-chain against source.
Transaction Digest: 5UQ7KuURAeMEdkQLAYq6NqM56VTLUDkkSG9WYQ8nh9Dk
```

æ§åˆ¶å°æ­¤ä¿¡æ¯åŒ…å«äº†å‘å¸ƒçš„äº¤æ˜“æ‘˜è¦: `Transaction Digest: 5UQ7KuURAeMEdkQLAYq6NqM56VTLUDkkSG9WYQ8nh9Dk`

æˆ‘ä»¬å¯ä»¥é€šè¿‡åŒºå—æµè§ˆå™¨è¿›è¡ŒæŸ¥çœ‹å…·ä½“çš„ä¿¡æ¯ï¼šhttps://testnet.suivision.xyz/txblock/5UQ7KuURAeMEdkQLAYq6NqM56VTLUDkkSG9WYQ8nh9Dk

æŸ¥è¯¢æ—¶äº¤æ˜“æ‘˜è¦éœ€æ›¿æ¢ä¸ºä½ å‘å¸ƒåŒ…çš„æ‘˜è¦ä¿¡æ¯ã€‚

![counter-info.png](https://img.learnblockchain.cn/attachments/2024/12/2Yk8HxxW675712f7cf078.png)
ä¹Ÿå¯åœ¨æ§åˆ¶å°æŸ¥çœ‹ä¿¡æ¯ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º
```text
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ Object Changes                                                                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Created Objects:                                                                                 â”‚
â”‚  â”Œâ”€â”€                                                                                             â”‚
â”‚  â”‚ ObjectID: 0xd717e1dc9011acb282da01c5fbc5d2dacb795c145b91e64c08fa618362893463                  â”‚
â”‚  â”‚ Sender: 0x5a684e30c7760309906a4ed7b25e2d0c4bbeff74a3995a8ccbfe49be084d16d0                    â”‚
â”‚  â”‚ Owner: Account Address ( 0x5a684e30c7760309906a4ed7b25e2d0c4bbeff74a3995a8ccbfe49be084d16d0 ) â”‚
â”‚  â”‚ ObjectType: 0x2::package::UpgradeCap                                                          â”‚
â”‚  â”‚ Version: 243530746                                                                            â”‚
â”‚  â”‚ Digest: 8pWgX77LTK5CRAg651foQpMauQKq7t9Y4GESvpUf6nyR                                          â”‚
â”‚  â””â”€â”€                                                                                             â”‚
â”‚ Mutated Objects:                                                                                 â”‚
â”‚  â”Œâ”€â”€                                                                                             â”‚
â”‚  â”‚ ObjectID: 0x632d35058587efd468ac3fa5f8fbe6c17a599e51806710f910ac7aa0c3747e3e                  â”‚
â”‚  â”‚ Sender: 0x5a684e30c7760309906a4ed7b25e2d0c4bbeff74a3995a8ccbfe49be084d16d0                    â”‚
â”‚  â”‚ Owner: Account Address ( 0x5a684e30c7760309906a4ed7b25e2d0c4bbeff74a3995a8ccbfe49be084d16d0 ) â”‚
â”‚  â”‚ ObjectType: 0x2::coin::Coin<0x2::sui::SUI>                                                    â”‚
â”‚  â”‚ Version: 243530746                                                                            â”‚
â”‚  â”‚ Digest: AWGTQQZ5hsvguk4GKpEvQkDdAFNmkKjHrCehpXx4n9Dx                                          â”‚
â”‚  â””â”€â”€                                                                                             â”‚
â”‚ Published Objects:                                                                               â”‚
â”‚  â”Œâ”€â”€                                                                                             â”‚
â”‚  â”‚ PackageID: 0x7fb2fd5c8ce79106206eda8759b7569588479c4057673e38113d4bf07361e23c                 â”‚
â”‚  â”‚ Version: 1                                                                                    â”‚
â”‚  â”‚ Digest: BbbQT37SUxtRcnvv43dyBfejyDiDTSveog7yKE9Xxdcp                                          â”‚
â”‚  â”‚ Modules: counter_contracts                                                                    â”‚
â”‚  â””â”€â”€                                                                                             â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

### å‰ç«¯éƒ¨åˆ†è®²è§£
> ç¯å¢ƒè¦æ±‚ï¼š å¿…é¡»å®‰è£… node , npm
å‰ç«¯å…¥é—¨å¯ä»¥å‚è€ƒä¹‹å‰çš„æ–‡ç« :[å¦‚ä½•ä½¿ç”¨dapp-kitæ„å»ºåº”ç”¨](https://learnblockchain.cn/article/10163)
å®˜æ–¹ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ä¸ª`å¼€ç®±å³ç”¨`çš„æ¨¡æ¿,å¯¹äºå‰ç«¯ä¸å¤ªç†Ÿæ‚‰åˆéœ€è¦çœ‹ä¸‹åˆçº¦æˆæœçš„åŒå­¦ï¼Œå¯ä»¥ç›´æ¥é‡‡ç”¨å®˜æ–¹æ¨¡æ¿ï¼Œè¿›è¡Œé¡¹ç›®äº¤äº’é¢„è§ˆã€‚

ä½¿ç”¨å®˜æ–¹æä¾›çš„æ¨¡æ¿è„šæ‰‹æ¶åˆ›å»ºé¡¹ç›®ï¼š

```shell
npm create @mysten/dapp --template react-e2e-counter
```
å¦‚æœå¸Œæœ›å¯ä»¥è‡ªå·±è®¾è®¡å‰ç«¯ä»¥åŠäº¤äº’é€»è¾‘ï¼Œå¯ä»¥ä½¿ç”¨

```shell
npm create @mysten/dapp --template react-client-dapp
```

å½“å‘½ä»¤è¿è¡Œå®Œæ¯•åï¼Œå°†åœ¨å‘½ä»¤è¡Œçª—å£æç¤ºä½ è¾“å…¥ä½ çš„é¡¹ç›®åç§°ï¼Œä¹‹åå°†æ ¹æ®æ¨¡æ¿åˆ›å»ºä¸€ä¸ªé¡¹ç›®åŸºç¡€éª¨æ¶ã€‚

æœ¬èŠ‚æˆ‘ä»¬ç›´æ¥ä½¿ç”¨å®˜æ–¹æä¾›çš„é¡¹ç›®æ¨¡æ¿ï¼Œä¸ç€é‡ä»‹ç»å¦‚ä½•è®¾è®¡å‰ç«¯ï¼Œå¦‚ä½•å¼€å‘åŠäº¤äº’ã€‚

å½“ä½ é€šè¿‡ä»¥ä¸Šå‘½ä»¤åˆ›å»ºå¥½å‰ç«¯åï¼Œä½ å°†çœ‹åˆ°ä»¥ä¸‹çš„é¡¹ç›®éª¨æ¶ï¼š

![counter.png](https://img.learnblockchain.cn/attachments/2024/12/LLMbhBPF6757130a55403.png)

å®˜æ–¹æ¨¡æ¿ä¸­è‡ªå¸¦äº†ä¸€ä¸ªåˆçº¦æ–‡ä»¶å¤¹ï¼Œä»¥åŠå‰ç«¯é¡¹ç›®ã€‚æœ¬æ–‡å°†é‡‡ç”¨ä¸Šé¢çš„åˆçº¦éƒ¨åˆ†ä»£ç åšç¤ºä¾‹ã€‚

æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè„šæ‰‹æ¶å·²ç»å¸®æˆ‘ä»¬å¼•å…¥äº†åŸºç¡€ä¾èµ–

![counter-react.png](https://img.learnblockchain.cn/attachments/2024/12/wEiwCpVK6757132065a7d.png)

æˆ‘ä»¬é€šè¿‡`npm install`å‘½ä»¤è¿›è¡Œå®‰è£…ä¾èµ–ã€‚

```shell
npm install
```
å®‰è£…å®Œæˆåï¼Œæˆ‘ä»¬é€šè¿‡``npm run dev` å°†é¡¹ç›®å¯åŠ¨

```shell
npm run dev
```

![counter-run.png](https://img.learnblockchain.cn/attachments/2024/12/QHoBCou56757133040e53.png)

é€šè¿‡è®¿é—®æ§åˆ¶å°è¾“å…¥åœ°å€ï¼Œå°±å¯ä»¥è®¿é—®æˆ‘ä»¬çš„`Dapp`äº†ã€‚

![counter-page.png](https://img.learnblockchain.cn/attachments/2024/12/obdcPlMb67571338bfabb.png)

ç°åœ¨æˆ‘ä»¬å·²ç»å°†å‰ç«¯é¡µé¢å¯åŠ¨ï¼Œä¹Ÿå¯¹é¡¹ç›®æœ‰äº†ä¸€ä¸ªå¤§è‡´çš„äº†è§£äº†ï¼Œå½“æ—¶æ­¤æ—¶ä½ é€šè¿‡é’±åŒ…å»é“¾æ¥é¡¹ç›®ï¼Œå¹¶åˆ›å»ºè®¡æ•°å™¨ï¼Œæ˜¯æ— æ³•ä½¿ç”¨çš„ï¼Œæˆ‘ä»¬éœ€è¦æ”¹é€ éƒ¨åˆ†ä»£ç ï¼Œæ‰èƒ½
æ˜¯`Dapp`æ­£å¸¸ä½¿ç”¨ã€‚

åœ¨æ¨¡æ¿ä¸­ï¼Œconstants.tsæ˜¯å­˜æ”¾æˆ‘ä»¬éƒ¨ç½²çš„åˆçº¦åŒ…çš„ä¿¡æ¯çš„é…ç½®æ–‡ä»¶ï¼Œæˆ‘ä»¬éœ€è¦å°†ä¸Šé¢æˆ‘ä»¬éƒ¨ç½²çš„åˆçº¦åŒ…ä¿¡æ¯æ›´æ–°åˆ°æ­¤å¤„ã€‚

![counter-constants.png](https://img.learnblockchain.cn/attachments/2024/12/bdS2YZBT675713475d627.png)
åœ¨è¯¥æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é…ç½®åˆçº¦çš„ä¸»ç½‘ï¼Œæµ‹è¯•ç½‘ï¼Œå¼€å‘ç½‘å‘å¸ƒçš„åŒ…id,å½“ç„¶å…·ä½“ç¯å¢ƒå–å†³äºä½ å‘å¸ƒåœ¨é‚£ä¸ªç½‘ç»œã€‚

æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬ä¿®æ”¹åœ¨åº”ç”¨ä¸­ç½‘ç»œç¯å¢ƒçš„é…ç½®ï¼šnetworkConfig.ts
```typescript
import { getFullnodeUrl } from "@mysten/sui/client";
//å¼•å…¥ä¹‹å‰å®šä¹‰çš„PACKAGEID
import {
  DEVNET_COUNTER_PACKAGE_ID,
    TESTNET_COUNTER_PACKAGE_ID,
  MAINNET_COUNTER_PACKAGE_ID,
} from "./constants.ts";
import { createNetworkConfig } from "@mysten/dapp-kit";

const { networkConfig, useNetworkVariable, useNetworkVariables } =
  createNetworkConfig({
    devnet: {
        //è·å–å®˜æ–¹æä¾›çš„å¼€å‘èŠ‚ç‚¹URL
      url: getFullnodeUrl("devnet"),
        //å¢åŠ å˜é‡å¼€å‘ç¯å¢ƒçš„åŒ…ID
      variables: {
        counterPackageId: DEVNET_COUNTER_PACKAGE_ID,
      },
    },
    testnet: {
        //è·å–å®˜æ–¹æä¾›çš„å¼€å‘èŠ‚ç‚¹URL
      url: getFullnodeUrl("testnet"),
        //å¢åŠ å˜é‡å¼€å‘ç¯å¢ƒçš„åŒ…ID
      variables: {
        counterPackageId: TESTNET_COUNTER_PACKAGE_ID,
      },
    },
    mainnet: {
        //è·å–å®˜æ–¹æä¾›çš„å¼€å‘èŠ‚ç‚¹URL
      url: getFullnodeUrl("mainnet"),
        //å¢åŠ å˜é‡å¼€å‘ç¯å¢ƒçš„åŒ…ID
      variables: {
        counterPackageId: MAINNET_COUNTER_PACKAGE_ID,
      },
    },
  });

export { useNetworkVariable, useNetworkVariables, networkConfig };
```
æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ­¤æ–‡ä»¶ä¸­é…ç½®äº†ä¸‰ä¸ªç¯å¢ƒï¼Œå¹¶å¼•å…¥äº†å„ä¸ªç¯å¢ƒçš„åŒ…`PACKAGEID`,ä¹‹åæˆ‘ä»¬å°†ä¼šåœ¨`SuiClientProvider`ç»„ä»¶ä¸­ä½¿ç”¨å®ƒã€‚

å‰ç«¯å…¥å£é¡µé¢ï¼š`main.tsx`
```typescript jsx
import React from "react";
import ReactDOM from "react-dom/client";
import "@mysten/dapp-kit/dist/index.css";
import "@radix-ui/themes/styles.css";

import { SuiClientProvider, WalletProvider } from "@mysten/dapp-kit";
import { QueryClient, QueryClientProvider } from "@tanstack/react-query";
import { Theme } from "@radix-ui/themes";
import App from "./App.tsx";
import { networkConfig } from "./networkConfig.ts";

const queryClient = new QueryClient();

ReactDOM.createRoot(document.getElementById("root")!).render(
    <React.StrictMode>
        <Theme appearance="dark">
            <QueryClientProvider client={queryClient}>
                <SuiClientProvider networks={networkConfig} defaultNetwork="testnet">
                    <WalletProvider autoConnect>
                        <App />
                    </WalletProvider>
                </SuiClientProvider>
            </QueryClientProvider>
        </Theme>
    </React.StrictMode>,
);

```
åœ¨å…¥å£é¡µï¼Œæˆ‘ä»¬é€šè¿‡å¼•å…¥å®˜æ–¹QueryClientProviderï¼ŒSuiClientProviderï¼ŒWalletProviderï¼Œç”¨äºåˆå§‹åŒ–ç½‘ç»œç¯å¢ƒä»¥åŠé’±åŒ…ç»„ä»¶ã€‚

å¹¶é€šè¿‡å¼•å…¥è‡ªå®šä¹‰çš„Appç»„ä»¶ï¼Œå®ç°åˆçº¦é€»è¾‘ã€‚

åˆ›å»ºè®¡æ•°å™¨ç»„ä»¶:`CreateCounter.tsx`

æ­¤ä¸ºä¸»è¦ä¸åˆçº¦äº¤äº’çš„é¡µé¢ï¼š

```typescript jsx
import { Transaction } from "@mysten/sui/transactions";
import { Button, Container } from "@radix-ui/themes";
import { useSignAndExecuteTransaction, useSuiClient } from "@mysten/dapp-kit";
import { useNetworkVariable } from "./networkConfig";
import ClipLoader from "react-spinners/ClipLoader";

export function CreateCounter({
  onCreated,
}: {
  onCreated: (id: string) => void;
}) {
  const counterPackageId = useNetworkVariable("counterPackageId");
  const suiClient = useSuiClient();
  const {
    mutate: signAndExecute,
    isSuccess,
    isPending,
  } = useSignAndExecuteTransaction();

  function create() {
    const tx = new Transaction();

    tx.moveCall({
      arguments: [],
      target: `${counterPackageId}::counter_contracts::create`,
    });

    signAndExecute(
      {
        transaction: tx,
      },
      {
        onSuccess: async ({ digest }) => {
          const { effects } = await suiClient.waitForTransaction({
            digest: digest,
            options: {
              showEffects: true,
            },
          });

          onCreated(effects?.created?.[0]?.reference?.objectId!);
        },
      },
    );
  }

  return (
    <Container>
      <Button
        size="3"
        onClick={() => {
          create();
        }}
        disabled={isSuccess || isPending}
      >
        {isSuccess || isPending ? <ClipLoader size={20} /> : "Create Counter"}
      </Button>
    </Container>
  );
}

```
æˆ‘ä»¬é€šè¿‡`useNetworkVariable("counterPackageId")`,è·å–å½“å‰ç¯å¢ƒä¸­é…ç½®çš„`PACKAGEID`,è¿™ä¸ªåœ¨constants.tså®šä¹‰è¿‡ï¼Œå¹¶é€šè¿‡ç”¨æˆ·é¡µé¢è¿æ¥é’±åŒ…åï¼Œ

é€šè¿‡é¡µé¢å€¼ä¼ é€’è¿‡æ¥ã€‚

é€šè¿‡`const suiClient = useSuiClient();` åˆå§‹åŒ–ä¸€ä¸ªsuiçš„è¿æ¥å®¢æˆ·ç«¯ï¼Œä¹‹åå°†é€šè¿‡æ­¤å®¢æˆ·ç«¯è¿æ¥ï¼Œè°ƒç”¨æˆ‘ä»¬çš„åˆçº¦æ–¹æ³•ã€‚

è¯¥é¡µé¢å£°æ˜äº†ä¸€ä¸ª`create()`æ–¹æ³•ï¼Œ

å¹¶é€šè¿‡PTBç¼–ç¨‹è¿›è¡Œåˆçº¦è°ƒç”¨ï¼šå£°æ˜ä¸€ä¸ªäº‹åŠ¡å¯¹è±¡ï¼Œå¹¶ä½¿ç”¨moveCallæ–¹æ³•ï¼Œè°ƒç”¨åˆçº¦çš„`counter_contracts::create`ï¼Œç»„è£…äº‹åŠ¡

é€šè¿‡`useSignAndExecuteTransaction`ç­¾åå¹¶æ‰§è¡Œäº‹åŠ¡ã€‚
PTBç¼–ç¨‹å¯ä»¥å‚è€ƒï¼š[SUIä¸­çš„PTBç¼–ç¨‹å…¥é—¨](https://learnblockchain.cn/article/10166)


æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬é€šè¿‡åº”ç”¨ä¸»é¡µé¢`App.tsx`è¿›è¡Œå¼•å…¥ `CreateCounter`ç»„ä»¶
```typescript jsx
import { ConnectButton, useCurrentAccount } from "@mysten/dapp-kit";
import { isValidSuiObjectId } from "@mysten/sui/utils";
import { Box, Container, Flex, Heading } from "@radix-ui/themes";
import { useState } from "react";
import { Counter } from "./Counter";
import { CreateCounter } from "./CreateCounter";

function App() {
  const currentAccount = useCurrentAccount();
  const [counterId, setCounter] = useState(() => {
    const hash = window.location.hash.slice(1);
    return isValidSuiObjectId(hash) ? hash : null;
  });

  return (
    <>
      <Flex
        position="sticky"
        px="4"
        py="2"
        justify="between"
        style={{
          borderBottom: "1px solid var(--gray-a2)",
        }}
      >
        <Box>
          <Heading>dApp Starter Template</Heading>
        </Box>

        <Box>
          <ConnectButton />
        </Box>
      </Flex>
      <Container>
        <Container
          mt="5"
          pt="2"
          px="4"
          style={{ background: "var(--gray-a2)", minHeight: 500 }}
        >
          {currentAccount ? (
            counterId ? (
              <Counter id={counterId} />
            ) : (
              <CreateCounter
                onCreated={(id) => {
                  window.location.hash = id;
                  setCounter(id);
                }}
              />
            )
          ) : (
            <Heading>Please connect your wallet</Heading>
          )}
        </Container>
      </Container>
    </>
  );
}

export default App;
```
é¡µé¢ä¸­å¼•å…¥äº†`CreateCounter`,`Counter`,`ConnectButton`,åˆ†åˆ«æ˜¯åˆ›å»ºè®¡æ•°å™¨ï¼Œè®¡æ•°å™¨é€’å¢åŠé‡ç½®ï¼Œé’±åŒ…è¿æ¥ç»„ä»¶ã€‚

`Counter`ç»„ä»¶æˆ‘ä»¬å°±æš‚ä¸ä»‹ç»ï¼Œå’Œ`CreateCounter`ä¸€æ ·ï¼Œé€šè¿‡PTBç¼–ç¨‹ï¼Œè°ƒç”¨çš„åˆçº¦çš„é€’å¢å‡½æ•°ä»¥åŠé‡ç½®å‡½æ•°ã€‚

åˆ°æ­¤æˆ‘ä»¬é¡µé¢ç»†èŠ‚å¤§è‡´ä»‹ç»å®Œæ¯•ï¼Œé€šè¿‡ä¿®æ”¹åŒ…é…ç½®ä»¥åŠç½‘ç»œé…ç½®ï¼Œé¡¹ç›®å·²ç»æ”¹é€ å®Œæˆã€‚

æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å¯åŠ¨é¡¹ç›®ï¼Œå°±å¯ä»¥è¿›è¡Œæµ‹è¯•ï¼Œæ˜¯å¦ç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸã€‚
```shell
npm run dev
```
è¿è¡Œä¸Šè¿°å‘½ä»¤ï¼Œæˆ‘ä»¬é€šè¿‡æ§åˆ¶å°æ‰“å°çš„é¡¹ç›®åœ°å€è¿›è¡Œè®¿é—®ï¼Œå¹¶è¯•éªŒåˆçº¦æ˜¯å¦èƒ½æ­£ç¡®è°ƒç”¨ã€‚

![counter-run.png](https://img.learnblockchain.cn/attachments/2024/12/Tc1K6UC36757135fe09a3.png)
é¡µé¢è¿æ¥é’±åŒ…ï¼š

![counter-wallet.png](https://img.learnblockchain.cn/attachments/2024/12/iMA3SuY2675713692b475.png)
å› ä¸ºæœ¬åœ°ç½‘é¡µåœ°å€ï¼Œé’±åŒ…ä¼šæç¤ºä¸å¯ä¿¡ï¼Œæˆ‘ä»¬é€‰æ‹©`continue`ä¿¡ä»»æ­¤ç½‘å€å³å¯ã€‚

![wallet-connect.png](https://img.learnblockchain.cn/attachments/2024/12/JHmbw2Qt67571379b26ac.png)

è¿æ¥åé¡µé¢æ˜¾ç¤º:

![create-counter.png](https://img.learnblockchain.cn/attachments/2024/12/Su5KsjZF6757138fafc89.png)
å¦‚æœæœªåˆ›å»ºï¼Œä¼šæŒ‰æ—¶`create`æŒ‰é’®ï¼Œå¯ä»¥åˆ›å»ºè®¡æ•°å™¨å¯¹è±¡

![counter-object.png](https://img.learnblockchain.cn/attachments/2024/12/SEk2uFCz67571399c7f17.png)
åˆ›å»ºåï¼Œå°†ä¼šå°†å¯¹è±¡IDæ”¾å…¥è·¯ç”±åœ°å€ï¼Œä¹‹åæºå¸¦å¯¹è±¡IDå³å¯è®¿é—®åˆ›å»ºçš„è®¡æ•°å™¨ï¼Œå½“ç„¶å½“ä½ å‘å¸ƒåœ¨äº’è”ç½‘æ—¶ï¼Œä½ å¯ä»¥é€šè¿‡å¯¹è±¡åœ°å€è®©åˆ«äººè®¿é—®ä½ çš„è®¡æ•°å™¨ã€‚

```text
http://localhost:5173/#0x10a3a3cbd7f9497d4361f4191e0fb1140fa528a912e13c5a3ac7a6d7f5bacb4b
```
æˆ‘ä»¬å¯ä»¥é€šè¿‡`increment` å’Œ`reset`æŒ‰é’®ï¼Œè¿›è¡Œè®¡æ•°å™¨çš„é€’å¢ï¼Œä»¥åŠé‡ç½®è®¡æ•°å™¨(å½“ç„¶ï¼Œé‡ç½®åªæœ‰åˆ›å»ºè®¡æ•°å™¨å¯¹è±¡çš„åœ°å€æ‰èƒ½è°ƒç”¨æˆåŠŸï¼Œè¿™ä¸ªæˆ‘ä»¬åœ¨ä¹‹å‰çš„åˆçº¦ä¸­åšè¿‡é™åˆ¶)

![increment-reset.png](https://img.learnblockchain.cn/attachments/2024/12/f0u7zVWv675713a6b8c88.png)
åˆ°æ­¤ï¼Œå·²ç»åŸºæœ¬å®Œæˆæœ€åŸºç¡€çš„ä¸€ä¸ªåˆ†å¸ƒå¼è®¡æ•°å™¨`DAPP`,å¸Œæœ›ä½ èƒ½æœ‰æ‰€è·ã€‚

## æ€»ç»“
é€šè¿‡å¯¹æœ¬èŠ‚çš„å­¦ä¹ ï¼Œæˆ‘ä»¬å­¦ä¹ äº†ç¼–å†™ä¸€ä¸ªåˆçº¦å¹¶å‘å¸ƒï¼Œåˆ°é€šè¿‡å‰ç«¯è¿›è¡Œè°ƒç”¨åˆçº¦æ–¹æ³•ï¼Œæ­¤å®æˆ˜å¯ä»¥ä½¿æˆ‘ä»¬ä»0-1å»ºé€ ä¸€ä¸ªæœ€åŸºç¡€çš„åŒºä¸­å¿ƒåº”ç”¨

å·©å›ºæˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„ç»“æ„ä½“ï¼Œå‡½æ•°ï¼Œå˜é‡ï¼Œåœ°å€ä»¥åŠå¯¹è±¡æ‰€æœ‰æƒçŸ¥è¯†ç‚¹ï¼Œä¹Ÿé€šè¿‡å‰ç«¯å­¦ä¹ ï¼Œä½¿ç”¨`dapp-kit`å’Œ`sui-sdk`è¿›è¡Œåˆçº¦è°ƒç”¨ï¼Œåˆæ­¥å…¥é—¨äº†ä¸€ä¸ª`dapp`çš„

å¼€å‘æµç¨‹ã€‚

ğŸ’§Â  [HOHæ°´åˆ†å­å…¬ä¼—å·](https://mp.weixin.qq.com/s/d0brr-ao6cZ5t8Z5OO1Mog)

ğŸŒŠÂ  [HOHæ°´åˆ†å­Xè´¦å·](https://x.com/0xHOH)

ğŸ“¹Â  [è¯¾ç¨‹Bç«™è´¦å·](https://space.bilibili.com/3493269495352098)

ğŸ’»Â  Githubä»“åº“ https://github.com/move-cn/letsmove