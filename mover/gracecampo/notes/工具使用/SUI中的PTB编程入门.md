# SUIä¸­çš„PTBç¼–ç¨‹å…¥é—¨

ğŸ§‘â€ğŸ’»ä½œè€…ï¼šgracecampo
## ä»€ä¹ˆæ˜¯PTB

### PTBå®šä¹‰
PTB(Building Programmable Transaction Blocks) çš„ä¸­æ–‡ç›´è¯‘æ˜¯å¯ç¼–ç¨‹çš„äº‹ç‰©å—ï¼Œè¿™ç§æè¿°å¯¹äºsuiæ–°äººæ¥è¯´å¾ˆå…·å¤‡è¿·æƒ‘æ€§ã€‚

[å®˜æ–¹é‡Šä¹‰]

å¯ç¼–ç¨‹äº¤æ˜“å—ï¼ˆPTBï¼‰æ˜¯ Sui åŒºå—é“¾ä¸­çš„ä¸€ç§äº¤æ˜“å½¢å¼ï¼Œå…è®¸åœ¨å•ä¸ªäº¤æ˜“ä¸­æ‰§è¡Œå¤šä¸ªå‘½ä»¤ã€‚PTB å¯ä»¥åœ¨ä¸å‘å¸ƒæ–°çš„ Move åŒ…çš„æƒ…å†µä¸‹è°ƒç”¨å¤šä¸ª Move å‡½æ•°ã€ç®¡ç†å¯¹è±¡å’Œç®¡ç†ä»£å¸ã€‚
å®ƒä»¬è®¾è®¡ä¸ºè½»é‡çº§ä¸”çµæ´»ï¼Œé€‚ç”¨äºè‡ªåŠ¨åŒ–å’Œäº¤æ˜“æ„å»ºå™¨ã€‚

PTB çš„ç‰¹ç‚¹åŒ…æ‹¬ï¼š

- ç”±å¤šä¸ªæŒ‰é¡ºåºé“¾æ¥çš„å‘½ä»¤ç»„æˆï¼Œä½†æ˜¯*å‘½ä»¤çš„æ‰§è¡Œæ—¶ä¸²è¡Œçš„*ã€‚
- äº¤æ˜“æ˜¯åŸå­çš„ï¼Œå¦‚æœä¸€ä¸ªå‘½ä»¤å¤±è´¥ï¼Œæ•´ä¸ªå—éƒ½ä¼šå¤±è´¥ã€‚
- å¯ä»¥åœ¨ä¸€æ¬¡æ‰§è¡Œä¸­æ‰§è¡Œå¤šè¾¾ 1024 ä¸ªç‹¬ç‰¹çš„æ“ä½œï¼Œè¿™æ¯”ä¼ ç»ŸåŒºå—é“¾ä¸Šçš„å•ç‹¬äº¤æ˜“æ›´å…·æˆæœ¬æ•ˆç›Šã€‚

æœ‰å…³ PTB çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… [Programmable Transaction Blocks](https://docs.sui.io/concepts/transactions/prog-txn-blocks)ã€‚

### PTBå¦‚ä½•æé«˜äº¤æ˜“çš„æ•ˆç‡å’Œé™ä½è´¹ç”¨ï¼Ÿ

å¯ç¼–ç¨‹äº¤æ˜“å—ï¼ˆPTBï¼‰é€šè¿‡ä»¥ä¸‹æ–¹å¼æé«˜äº¤æ˜“æ•ˆç‡å’Œé™ä½è´¹ç”¨ï¼š

1. **æ‰¹é‡æ“ä½œ**ï¼šPTB å¯ä»¥åœ¨å•ä¸ªäº¤æ˜“ä¸­æ‰§è¡Œå¤šè¾¾ 1024 ä¸ªæ“ä½œï¼Œè¿™æ„å‘³ç€å¯ä»¥å°†å¤šä¸ªäº¤æ˜“åˆå¹¶ä¸ºä¸€ä¸ªäº¤æ˜“å—ã€‚è¿™ç§æ‰¹é‡å¤„ç†å‡å°‘äº†å•ç‹¬æ‰§è¡Œæ¯ä¸ªäº¤æ˜“æ‰€éœ€çš„æ—¶é—´å’Œèµ„æºã€‚

2. **åŸå­æ€§**ï¼šæ‰€æœ‰å‘½ä»¤åœ¨ä¸€ä¸ªäº¤æ˜“ä¸­æ‰§è¡Œï¼Œå¦‚æœä¸€ä¸ªå‘½ä»¤å¤±è´¥ï¼Œæ•´ä¸ªäº¤æ˜“å—éƒ½ä¼šå¤±è´¥ã€‚è¿™ç¡®ä¿äº†äº¤æ˜“çš„ä¸€è‡´æ€§å’Œå¯é æ€§ï¼Œé¿å…äº†éƒ¨åˆ†æ‰§è¡Œçš„æƒ…å†µã€‚

3. **é™ä½ gas è´¹ç”¨**ï¼šç”±äºå¤šä¸ªæ“ä½œè¢«åˆå¹¶ä¸ºä¸€ä¸ªäº¤æ˜“æ‰§è¡Œï¼ŒPTB çš„ gas è´¹ç”¨é€šå¸¸ä½äºåœ¨ä¼ ç»ŸåŒºå—é“¾ä¸Šå•ç‹¬æ‰§è¡Œæ¯ä¸ªäº¤æ˜“çš„è´¹ç”¨ã€‚è¿™æ˜¯å› ä¸ºåˆå¹¶äº¤æ˜“å‡å°‘äº†é‡å¤çš„æ“ä½œå’Œèµ„æºæ¶ˆè€—ã€‚

4. **å¹¶è¡ŒåŒ–**ï¼šPTB æ”¯æŒå¹¶è¡Œæ‰§è¡Œå¤šä¸ªç‹¬ç«‹çš„äº¤æ˜“ï¼Œè¿™æé«˜äº†ç½‘ç»œçš„ååé‡å’Œæ•ˆç‡ï¼Œè¿›ä¸€æ­¥é™ä½äº†äº¤æ˜“è´¹ç”¨ã€‚

[ä¸ªäººç†è§£]
ç›¸æ¯”å•å‘½ä»¤æ‰§è¡Œï¼ŒPTBå¯ä»¥ä¸ºæˆ‘ä»¬èŠ‚çœgas,ä½†æ˜¯ä¹Ÿç›¸å¯¹å¯¹äºå¼€å‘äººå‘˜çš„æ°´å¹³æé«˜äº†è¦æ±‚ï¼Œè¦æ±‚å¼€å‘äººå‘˜éœ€è¦æœ‰è¶³å¤Ÿçš„çŸ¥è¯†å‚¨å¤‡ï¼Œä»¥åŠå¯¹ä»£ç é€»è¾‘çš„ç†è§£ã€‚

æˆ‘ä»¬å¯ä»¥ç®€å•çš„ç†è§£ä¸ºPTBæ˜¯ä¸€ç§åœ¨SUIä¸Šçš„æ„å»ºäº¤æ˜“å·¥å…·ï¼Œå®ƒå…è®¸æˆ‘ä»¬åœ¨ä¸€ä¸ªäº‹åŠ¡å†…ï¼Œæ‰§è¡Œå¤šæ¡å‘½ä»¤ï¼Œå°†ä¹‹å‰æˆ‘ä»¬æ“ä½œåŒºå—é“¾æ—¶ï¼Œå¤æ‚çš„äº¤æ˜“æµç¨‹ï¼Œç»„åˆä¸ºå¤šæ¡å‘½ä»¤çš„
å‘½ä»¤é›†åˆï¼Œç„¶åç»Ÿä¸€åœ¨ä¸€ä¸ªäº¤æ˜“åŒºå—å†…è¿›è¡Œæ‰§è¡Œã€‚

PTBå†…éƒ¨å‘½ä»¤æ˜¯æŒ‰ç…§é¡ºåºæ‰§è¡Œçš„ï¼Œå°±æ˜¯è¯´PTBçš„æ‰§è¡Œæ˜¯ä¸²è¡Œçš„ã€‚ åä¸€æ­¥çš„å‘½ä»¤ä¾èµ–äºå‰ä¸€æ­¥å‘½ä»¤çš„ç»“æœï¼Œæ•…è€Œè¯´æ˜¯ä¿æŒäº†äº¤æ˜“çš„ä¸€è‡´æ€§å’Œå¯é æ€§ã€‚

ä½†PTBæ˜¯å¹¶è¡ŒåŒ–çš„ï¼Œè¿™ä¸ªå¥½åƒåˆæ˜¯å’Œä¸Šé¢çš„å†²çªï¼Œå®é™…PTBå¹¶è¡Œçš„æ„æ€æ˜¯åœ¨suiç½‘ç»œä¸­ï¼Œå¯ä»¥å¹¶è¡Œæ‰§è¡Œå¤šä¸ªPTBå—ï¼Œå°±æ˜¯è¯´PTBå†…éƒ¨å‘½ä»¤æ˜¯ä¸²è¡Œçš„ï¼Œä½†æ˜¯ç½‘è·¯æ”¯æŒå¹¶è¡Œçš„
æ‰§è¡Œå¤šä¸ªPTBå—ã€‚

## å¦‚ä½•ä½¿ç”¨

æˆ‘ä»¬ä½¿ç”¨PTBå¯ä»¥æœ‰ä¸¤ç§æ–¹å¼ï¼š

ä½¿ç”¨å‘½ä»¤è¡Œæ„å»ºä¸€ä¸ªPTBå—

ä½¿ç”¨TypeScript SDKæ„å»ºPTBå—

### å‘½ä»¤è¡Œä½¿ç”¨PTB

æˆ‘ä»¬å¯ä»¥å…ˆæ¥æŸ¥çœ‹å‘½ä»¤è¡Œå…³äºPTBçš„å¸®åŠ©ä¿¡æ¯

```text

sui client ptb -h

Build, preview, and execute programmable transaction blocks. Depending on your shell, you might have to use quotes around arrays or other passed values. Use --help to see examples for how to use the core functionality of this
command.

Usage: sui client ptb [OPTIONS]

Options:
      --assign <NAME> <VALUE>                                              å®šä¹‰ä¸€ä¸ªå˜é‡,å¯ä»¥åœ¨ä¹‹åçš„å‘½ä»¤ä¸­å¼•ç”¨
      --dry-run                                                            PTBæ¨¡æ‹Ÿè¿è¡Œ
      --dev-inspect                                                        å¯¹PTBæ‰§è¡Œdevæ£€æŸ¥
      --gas-coin <ID>                                                      è¦ä½¿ç”¨çš„æ±½æ²¹å¸çš„å¯¹è±¡IDã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šï¼Œå®ƒå°†å°è¯•ä½¿ç”¨å®ƒå‘ç°çš„ç¬¬ä¸€ä¸ªè‡³å°‘å…·æœ‰æ‰€éœ€å¤©ç„¶æ°”é¢„ç®—ä½™é¢çš„å¤©ç„¶æ°”å¸ã€‚
      --gas-budget <MIST>                                                  æ­¤PTBçš„å¯é€‰æ°”ä½“é¢„ç®—ï¼ˆåœ¨MISTä¸­ï¼‰ã€‚å¦‚æœæ²¡æœ‰æä¾›å¤©ç„¶æ°”é¢„ç®—ï¼Œè¯¥å·¥å…·å°†é¦–å…ˆè¿›è¡Œæ¨¡æ‹Ÿè¿è¡Œä»¥ä¼°ç®—å¤©ç„¶æ°”æˆæœ¬ï¼Œç„¶åæ‰§è¡Œäº¤æ˜“ã€‚
                                                                           è¯·æ³¨æ„ï¼Œç”±äºé¢å¤–çš„æ¨¡æ‹Ÿè¿è¡Œè°ƒç”¨ï¼Œè¿™ä¼šå¸¦æ¥è¾ƒå°çš„æ€§èƒ½æˆæœ¬ã€‚                                                                     
      --make-move-vec <TYPE> <[VALUES]>                                    ç»™å®šç›¸åŒç±»å‹çš„nä¸ªå€¼ï¼Œå®ƒæ„é€ ä¸€ä¸ªå‘é‡ã€‚å¯¹äºéå¯¹è±¡æˆ–ç©ºå‘é‡ï¼Œå¿…é¡»æŒ‡å®šç±»å‹æ ‡è®°ã€‚
      --merge-coins <INTO_COIN> <[COIN OBJECTS]>                           å°†Nä¸ªç¡¬å¸åˆå¹¶åˆ°æä¾›çš„ç¡¬å¸ä¸­ã€‚
      --move-call <PACKAGE::MODULE::FUNCTION> <TYPE_ARGS> <FUNCTION_ARGS>  å¯¹å‡½æ•°è¿›è¡Œç§»åŠ¨è°ƒç”¨ã€‚
      --split-coins <COIN> <[AMOUNT]>                                      æ ¹æ®ç»™å®šçš„é‡‘é¢æ•°ç»„å°†ç¡¬å¸åˆ†æˆNä¸ªç¡¬å¸ã€‚
      --transfer-objects <[OBJECTS]> <TO>                                  å°†å¯¹è±¡ä¼ è¾“åˆ°æŒ‡å®šåœ°å€ã€‚
      --publish <MOVE_PACKAGE_PATH>                                        å‘å¸ƒMoveåŒ…ï¼šæºç æ‰€åœ¨çš„æ–‡ä»¶å¤¹è·¯å¾„ä½œä¸ºè¾“å…¥ã€‚
      --upgrade <MOVE_PACKAGE_PATH>                                        å‡çº§Moveè½¯ä»¶åŒ…ï¼šæºç æ‰€åœ¨çš„æ–‡ä»¶å¤¹è·¯å¾„ä½œä¸ºè¾“å…¥ã€‚
      --preview                                                            é¢„è§ˆPTBäº‹åŠ¡åˆ—è¡¨ï¼Œè€Œä¸æ˜¯æ‰§è¡Œå®ƒä»¬ã€‚
      --serialize-unsigned-transaction                                     ä¸æ‰§è¡Œäº‹åŠ¡ï¼Œè€Œæ˜¯ä½¿ç”¨base64ç¼–ç å¯¹æœªç­¾åäº‹åŠ¡æ•°æ®çš„bcså­—èŠ‚è¿›è¡Œåºåˆ—åŒ–ã€‚
      --serialize-signed-transaction                                       ä¸æ‰§è¡Œäº‹åŠ¡ï¼Œè€Œæ˜¯ä½¿ç”¨base64ç¼–ç å¯¹å·²ç­¾åäº‹åŠ¡æ•°æ®çš„bcså­—èŠ‚è¿›è¡Œåºåˆ—åŒ–ã€‚
      --summary                                                            ä»…æ˜¾ç¤ºç®€çŸ­æ‘˜è¦ï¼ˆæ‘˜è¦ã€æ‰§è¡ŒçŠ¶æ€ã€æ°”ä½“æˆæœ¬ï¼‰ã€‚å½“æ‚¨éœ€è¦æ‰€æœ‰äº‹åŠ¡æ•°æ®å’Œæ‰§è¡Œæ•ˆæœæ—¶ï¼Œä¸è¦ä½¿ç”¨æ­¤æ ‡å¿—ã€‚
      --warn-shadows                                                       å½“å¤šæ¬¡å£°æ˜åŒä¸€å˜é‡åæ—¶ï¼Œå¯ç”¨é˜´å½±è­¦å‘Šã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ºå…³é—­ã€‚
      --json                                                               ä»¥jsonæ ¼å¼è¿”å›å‘½ä»¤è¾“å‡ºã€‚
  -h, --help                                                               æ‰“å°å¸®åŠ©ï¼ˆè¯¦è§â€œ--helpâ€ï¼‰
```

å‘½ä»¤ç»“æœæˆªå›¾ï¼š


![ptb-help.png](https://img.learnblockchain.cn/attachments/2024/12/RnQjCZZC67542e98896fa.png)

####  PTBç¤ºä¾‹ï¼š å°†åˆ†å‰²ä¸€ä¸ª gas coin å¹¶å°†å…¶è½¬ç§»åˆ°æŒ‡å®šåœ°å€ï¼š

```bash
sui client ptb \
--assign to_address @0x49e8d1c3e6596eb7926b2d1b22cd03eb12962d4ea5b5df8572da3e6fcfe60af5 \
--split-coins gas [1000,2000,3000] \
--assign coins \
--transfer-objects  [coins.0,coins.1,coins.2] to_address \
--gas-budget 5000000 \
--summary
```
### è§£é‡Šï¼š
- `--assign to_address @0x...`ï¼šæŒ‡å®šæ¥æ”¶åœ°å€ã€‚
- `--split-coins gas [1000,2000,3000]`ï¼šå°† gas coin åˆ†å‰²æˆä¸‰ä¸ªä¸åŒçš„å€¼ã€‚
- `--assign coins`ï¼šå°†åˆ†å‰²åçš„ coin ç»“æœèµ‹å€¼ç»™å˜é‡ `coins`ã€‚
- `--transfer-objects to_address [coins.0, coins.1, coins.2]`ï¼šå°†åˆ†å‰²åçš„ coins è½¬ç§»åˆ°æŒ‡å®šåœ°å€ã€‚
- `--gas-budget 5000000`ï¼šè®¾ç½® gas é¢„ç®—ã€‚
- `--summary`ï¼šä»…æ˜¾ç¤ºæ‰§è¡Œæ‘˜è¦ã€‚

æ‰§è¡Œç»“æœï¼š
```text
[warn] Client/Server api version mismatch, client api version : 1.37.2, server api version : 1.38.3
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ PTB Execution Summary                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Digest: 45AzyKXq3F8bfHmiD33iA5YdoPqVQuz2zftX6h6N7BRs â”‚
â”‚ Status: success                                      â”‚
â”‚ Gas Cost Summary:                                    â”‚
â”‚    Storage Cost: 3952000                             â”‚
â”‚    Computation Cost: 1000000                         â”‚
â”‚    Storage Rebate: 978120                            â”‚
â”‚    Non-refundable Storage Fee: 9880                  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```

è¿™ä¸ªç¤ºä¾‹å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ Sui CLI æ„å»ºå’Œæ‰§è¡Œä¸€ä¸ªç®€å•çš„ PTB,æ­¤PTBæ‰§è¡Œäº†ä¸¤ä¸ªå‘½ä»¤ï¼Œ--split-coinsï¼Œ--transfer-objectsã€‚

å¹¶ä½¿ç”¨--assign å£°æ˜äº†ä¸€ä¸ªåœ°å€å˜é‡ï¼š`to_address` å’Œ `coins`å˜é‡ï¼Œåœ¨ä½¿ç”¨--transfer-objectså‘½ä»¤æ—¶ï¼Œå°†coinså’Œto_addresså˜é‡ä½œä¸ºå…¥å‚ã€‚

#### PTBç¤ºä¾‹: å‘å¸ƒåˆçº¦,å¹¶è°ƒç”¨åˆçº¦,ç„¶åé“¸é€ ä¸€ä¸ªNFT,å¹¶å°†å…¶è½¬ç§»åˆ°æŒ‡å®šåœ°å€

>>å‘å¸ƒåˆçº¦

```shell
sui client ptb \
--move-call sui::tx_context::sender \
--assign sender \
--publish "åŒ…è·¯å¾„" \
--assign upgrade_cap \
--transfer-objects [upgrade_cap] sender \
--gas-budget \
--summary
```

æ­¤PTBå—ï¼Œæ‰§è¡Œäº†å‘å¸ƒåˆçº¦çš„å‘½ä»¤ï¼Œå¹¶å°†upgrade_capå¯¹è±¡è½¬ç§»è‡³è°ƒç”¨è€…åœ°å€
```text
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ PTB Execution Summary                                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Digest: FPMBYZNReDpFLSSosTcoEZnWbsNZzDq6UeLnod6iFqMq â”‚
â”‚ Status: success                                      â”‚
â”‚ Gas Cost Summary:                                    â”‚
â”‚    Storage Cost: 12084000                            â”‚
â”‚    Computation Cost: 1000000                         â”‚
â”‚    Storage Rebate: 978120                            â”‚
â”‚    Non-refundable Storage Fee: 9880                  â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯
```
>> è°ƒç”¨åˆçº¦

```shell
sui client ptb \
--move-call <PACKAGE-ID>::<MODULE>::<FUNCTION> <ARGS>  \
--assign result \
--transfer-objects [result] sender \
--gas-budget 5000000 \
--summary
```
å‘½ä»¤ä¾‹å­:
```shell
sui client ptb \
--move-call 0xc90615c1cbbc245cb6696c4164878aa89441f7531ec9654e9a0e5b3b839477fd::gracecampo_nft::mint_to_sender "'ptbnft'" "'ptb-desc'" "'https://pics0.baidu.com/feed/c8ea15ce36d3d539ff5971f5df97085e352ab0bb.jpeg'" \
--gas-budget 5000000 \
--summary
```
æ­¤å‘½ä»¤è°ƒç”¨äº†gracecampo_nftæ¨¡å—çš„mint_to_senderå‡½æ•°ï¼Œå¹¶ä¼ å…¥NFTåç§°ï¼ŒNFTæè¿°ï¼ŒNFTçš„URLé“¾æ¥

å…¶ä»–çš„å‘½ä»¤éƒ½å¯ä»¥ä½¿ç”¨è¿™ç§æ–¹å¼è°ƒç”¨ï¼Œæ„Ÿå…´è¶£çš„å¯ä»¥è‡ªè¡Œå°è¯•ã€‚

###  TypeScript SDK ä½¿ç”¨PTB
#### åˆå§‹åŒ–ä¸€ä¸ªnodeé¡¹ç›®

åˆ›å»ºå¹¶è¿›å…¥é¡¹ç›®ç›®å½•ï¼Œåˆå§‹åŒ–é¡¹ç›®
```shell
 mkdir ptb-project && cd ptb-project && npm init -y
```

![ptb-typeScript.png](https://img.learnblockchain.cn/attachments/2024/12/pBizZlWH67542ec146a97.png)

#### å¼•å…¥ä¾èµ–
```shell
npm install @mysten/sui
```
å®‰è£…åæŸ¥çœ‹package.json,æ­¤æ—¶å·²ç»å¼•å…¥äº†suiçš„sdkä¾èµ–ã€‚

![ptb-package.png](https://img.learnblockchain.cn/attachments/2024/12/pdub75x367542eaf73465.png)

#### ç¼–å†™PTBå‡½æ•°
åˆ›å»ºä¸€ä¸ªapp.jsä»£ç 
```typescript
import { Transaction } from '@mysten/sui/transactions';
import { getFullnodeUrl, SuiClient } from '@mysten/sui/client';
import { Ed25519Keypair } from '@mysten/sui/keypairs/ed25519';
import { getFaucetHost, requestSuiFromFaucetV0 } from '@mysten/sui/faucet';
// åˆ›å»ºä¸€ä¸ªè´¦å·
const keypair = new Ed25519Keypair();
const secretKey = keypair.getSecretKey();
console.log('Secret Key:', secretKey);
const address = keypair.getPublicKey().toSuiAddress();

//è·å–æ°´é¾™å¤´ä»£å¸
await requestSuiFromFaucetV0({
    host: getFaucetHost('testnet'),
    recipient: address,
});

//åˆ›å»ºä¸€ä¸ªå®¢æˆ·ç«¯
const client = new SuiClient({ url: getFullnodeUrl('testnet') });

//è·å–åœ°å€ä½™é¢
let balance = await client.getCoins({
    owner: address,
});
console.log(balance);
//åˆ›å»ºäº¤æ˜“
const tx = new Transaction();
//åˆ†å‰²coin
const [coin] = tx.splitCoins(tx.gas, [100]);
// æ‰§è¡Œå‡½æ•°
tx.transferObjects([coin], address);
//è°ƒç”¨é“¸é€ NFT
tx.moveCall({
    target: '0xc90615c1cbbc245cb6696c4164878aa89441f7531ec9654e9a0e5b3b839477fd::gracecampo_nft::mint_to_public',
    arguments: [
        tx.pure.string('ptbnft1'),
        tx.pure.string('ptb-desc'),
        tx.pure.string('https://pics0.baidu.com/feed/c8ea15ce36d3d539ff5971f5df97085e352ab0bb.jpeg'),
        tx.pure.address('0x5a684e30c7760309906a4ed7b25e2d0c4bbeff74a3995a8ccbfe49be084d16d0')
    ]
});
//è®¾ç½®gasè´¹
tx.setGasPrice(1000);
tx.setGasBudget(10000000);
//ç­¾åå¹¶å‘é€äº‹åŠ¡åˆ°é“¾ä¸Š
const result =await client.signAndExecuteTransaction({ signer: keypair, transaction: tx });

console.log(result);
```

è¯¥ä»£ç ä½¿ç”¨ä½¿ç”¨`new Ed25519Keypair()` åˆ›å»ºä¸€ä¸ªåœ°å€ï¼Œå¹¶é€šè¿‡`requestSuiFromFaucetV0`è·å–æ°´é¾™å¤´ä»£å¸ï¼Œå¹¶è°ƒç”¨`splitCoins`åˆ†å‰²ä»£å¸ï¼Œåœ¨é€šè¿‡
tx.moveCallè°ƒç”¨åˆçº¦é“¸é€ NFTã€‚

æ­¤ä»£ç é€šè¿‡PTBç¼–ç¨‹ï¼Œå°†ä¸‰ä¸ªå‘½ä»¤è¿›è¡Œç»„åˆï¼Œåœ¨ä¸€ä¸ªäº‹åŠ¡å—ä¸­æ‰§è¡Œã€‚


![ptb-tran.png](https://img.learnblockchain.cn/attachments/2024/12/3EjFpiJk67542ecf32cbb.png)

## æ€»ç»“
Programmable Transaction Blocks (PTBs) åœ¨ Sui ä¸­æä¾›äº†è®¸å¤šä¼˜ç‚¹ï¼š

1. **é«˜æ•ˆçš„æ‰¹å¤„ç†**ï¼šPTBs å…è®¸åœ¨å•ä¸ªäº¤æ˜“ä¸­è°ƒç”¨å¤šè¾¾ 1024 ä¸ªä¸åŒçš„ Move å‡½æ•°ã€‚è¿™ç§æ‰¹å¤„ç†èƒ½åŠ›æ˜¾è‘—æé«˜äº†äº¤æ˜“çš„æ•ˆç‡å’Œé™ä½äº† gas è´¹ç”¨ã€‚[äº†è§£æ›´å¤š](https://docs.sui.io/concepts/transactions/prog-txn-blocks)

2. **åŸå­æ€§**ï¼šPTBs ç¡®ä¿æ‰€æœ‰å‘½ä»¤çš„æ•ˆæœåœ¨äº¤æ˜“ç»“æŸæ—¶åŸå­æ€§åœ°åº”ç”¨ã€‚å¦‚æœå…¶ä¸­ä¸€ä¸ªå‘½ä»¤å¤±è´¥ï¼Œæ•´ä¸ªå—å°†å¤±è´¥ï¼Œä¸ä¼šåº”ç”¨ä»»ä½•æ•ˆæœã€‚[äº†è§£æ›´å¤š](https://github.com/sui-foundation/sui-move-intro-course/blob/ea12e0a1141763a1c4666b19ffe56fcfd07662cb/unit-five/lessons/1_programmable_transaction_block.md)

3. **çµæ´»æ€§å’Œå¯ç»„åˆæ€§**ï¼šPTBs å…è®¸å¼€å‘è€…åœ¨ä¸å‘å¸ƒæ–°çš„ Move åŒ…çš„æƒ…å†µä¸‹ç®¡ç†å¯¹è±¡å’Œè°ƒç”¨å¤šä¸ª Move å‡½æ•°ï¼Œä¸ºå¼€å‘è€…æä¾›äº†æ›´å¤§çš„çµæ´»æ€§ã€‚[äº†è§£æ›´å¤š](https://blog.sui.io/programmable-transaction-blocks-explained/)

4. **é™ä½è´¹ç”¨**ï¼šé€šè¿‡å°†å¤šä¸ªäº¤æ˜“åˆå¹¶ä¸ºä¸€ä¸ª PTBï¼Œå¼€å‘è€…å¯ä»¥æ˜¾è‘—é™ä½äº¤æ˜“è´¹ç”¨ï¼Œç‰¹åˆ«æ˜¯åœ¨ DeFi åº”ç”¨ä¸­ï¼Œè¿™ç§ä¼˜åŠ¿å°¤ä¸ºæ˜æ˜¾ã€‚[äº†è§£æ›´å¤š](https://blog.sui.io/defi-programmable-transaction-blocks/)

5. **ç®€åŒ–ä»£ç **ï¼šPTBs å°†ç»„åˆä»æ™ºèƒ½åˆçº¦çº§åˆ«ç§»åˆ°äº¤æ˜“çº§åˆ«ï¼Œç®€åŒ–äº†ä»£ç ç»“æ„ï¼Œæé«˜äº†å¯è¯»æ€§ã€‚[äº†è§£æ›´å¤š](https://sui.io/move)

è¿™äº›ç‰¹æ€§ä½¿å¾— PTBs æˆä¸ºåœ¨ Sui ä¸Šå¼€å‘é«˜æ•ˆã€å¤æ‚åº”ç”¨çš„å¼ºå¤§å·¥å…·ã€‚

é€šè¿‡å­¦ä¹ PTBç¼–ç¨‹å°†åœ¨æˆ‘ä»¬ä¹‹åçš„ç¼–ç¨‹æ´»åŠ¨ä¸­ï¼Œæä¾›ä¾¿åˆ©æ€§ã€‚

ğŸ’§Â  [HOHæ°´åˆ†å­å…¬ä¼—å·](https://mp.weixin.qq.com/s/d0brr-ao6cZ5t8Z5OO1Mog)

ğŸŒŠÂ  [HOHæ°´åˆ†å­Xè´¦å·](https://x.com/0xHOH)

ğŸ“¹Â  [è¯¾ç¨‹Bç«™è´¦å·](https://space.bilibili.com/3493269495352098)

ğŸ’»Â  Githubä»“åº“ https://github.com/move-cn/letsmove